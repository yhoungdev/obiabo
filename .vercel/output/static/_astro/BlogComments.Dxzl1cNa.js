import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as s}from"./index.WFquGv8Z.js";function w({postId:i}){const[n,x]=s.useState([]),[b,h]=s.useState(!0),[d,u]=s.useState(!1),[g,o]=s.useState(!1),[a,l]=s.useState({name:"",email:"",content:""}),[m,c]=s.useState(null);s.useEffect(()=>{y()},[i]);const y=async()=>{try{const r=await(await fetch(`/api/comments?postId=${i}`)).json();x(r.comments||[])}catch(t){console.error("Failed to fetch comments:",t)}finally{h(!1)}},p=async t=>{t.preventDefault(),u(!0),c(null);try{const r=await fetch("/api/comments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({postId:i,...a})}),j=await r.json();r.ok?(c({type:"success",text:"Comment submitted! It will appear after approval."}),l({name:"",email:"",content:""}),o(!1)):c({type:"error",text:j.error||"Failed to submit comment"})}catch{c({type:"error",text:"Failed to submit comment. Please try again."})}finally{u(!1)}},f=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return e.jsxs("div",{className:"mt-12 border-t border-gray-700 pt-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-100",children:["Comments ",n.length>0&&`(${n.length})`]}),!g&&e.jsx("button",{onClick:()=>o(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors text-white",children:"Leave a comment"})]}),m&&e.jsx("div",{className:`mb-6 p-4 rounded-lg ${m.type==="success"?"bg-green-500/10 border border-green-500 text-green-400":"bg-red-500/10 border border-red-500 text-red-400"}`,children:m.text}),g&&e.jsxs("form",{onSubmit:p,className:"mb-8 p-6 border border-gray-700 rounded-lg ",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-100",children:"Leave a comment"}),e.jsx("button",{type:"button",onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-300","aria-label":"Close form",children:"âœ•"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium mb-2 text-gray-300",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"name",required:!0,maxLength:100,value:a.name,onChange:t=>l({...a,name:t.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-gray-100 placeholder-gray-500 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500",placeholder:"Your name"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"email",className:"block text-sm font-medium mb-2 text-gray-300",children:["Email ",e.jsx("span",{className:"text-gray-500 text-xs",children:"(optional)"})]}),e.jsx("input",{type:"email",id:"email",value:a.email,onChange:t=>l({...a,email:t.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-gray-100 placeholder-gray-500 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500",placeholder:"your.email@example.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"content",className:"block text-sm font-medium mb-2 text-gray-300",children:["Comment ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"content",required:!0,maxLength:1e3,rows:4,value:a.content,onChange:t=>l({...a,content:t.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-gray-100 placeholder-gray-500 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 resize-y",placeholder:"Share your thoughts..."}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.content.length,"/1000 characters"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:d,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-white",children:d?"Submitting...":"Submit Comment"}),e.jsx("button",{type:"button",onClick:()=>o(!1),className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors text-gray-100",children:"Cancel"})]})]})]}),b?e.jsx("p",{className:"text-gray-400",children:"Loading comments..."}):n.length===0?e.jsx("p",{className:"text-gray-400 italic",children:"No comments yet. Be the first to share your thoughts!"}):e.jsx("div",{className:"space-y-6",children:n.map(t=>e.jsxs("div",{className:"p-6 border border-gray-700 rounded-lg hover:border-gray-600 transition-colors ",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-semibold bg-transparent text-lg text-gray-100",children:t.name}),e.jsx("time",{className:"text-sm text-gray-500",children:f(t.createdAt)})]}),e.jsx("p",{className:"text-gray-300 leading-relaxed whitespace-pre-wrap",children:t.content})]},t._id))})]})}export{w as default};
