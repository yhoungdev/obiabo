import{j as l}from"./jsx-runtime.D_zvdyIk.js";import{r as T}from"./index.WFquGv8Z.js";import{s as A}from"./_slug_.d0da9b78._LPRcd2g.js";function I(e){return e._type==="span"&&"text"in e&&typeof e.text=="string"&&(e.marks===void 0||Array.isArray(e.marks)&&e.marks.every(n=>typeof n=="string"))}function B(e){return typeof e._type=="string"&&e._type[0]!=="@"&&(!("markDefs"in e)||!e.markDefs||Array.isArray(e.markDefs)&&e.markDefs.every(n=>typeof n._key=="string"))&&"children"in e&&Array.isArray(e.children)&&e.children.every(n=>typeof n=="object"&&"_type"in n)}function S(e){return B(e)&&"listItem"in e&&typeof e.listItem=="string"&&(e.level===void 0||typeof e.level=="number")}function D(e){return e._type==="@list"}function M(e){return e._type==="@span"}function P(e){return e._type==="@text"}const v=["strong","em","code","underline","strike-through"];function C(e,n,t){if(!I(e)||!e.marks||!e.marks.length)return[];let r=e.marks.slice(),o={};return r.forEach(s=>{o[s]=1;for(let c=n+1;c<t.length;c++){let u=t[c];if(u&&I(u)&&Array.isArray(u.marks)&&u.marks.indexOf(s)!==-1)o[s]++;else break}}),r.sort((s,c)=>U(o,s,c))}function U(e,n,t){let r=e[n],o=e[t];if(r!==o)return o-r;let s=v.indexOf(n),c=v.indexOf(t);return s===c?n.localeCompare(t):s-c}function W(e){let{children:n}=e,t=e.markDefs??[];if(!n||!n.length)return[];let r=n.map(C),o={_type:"@span",children:[],markType:"<unknown>"},s=[o];for(let c=0;c<n.length;c++){let u=n[c];if(!u)continue;let y=r[c]||[],g=1;if(s.length>1)for(;g<s.length;g++){let i=s[g]?.markKey||"",a=y.indexOf(i);if(a===-1)break;y.splice(a,1)}s=s.slice(0,g);let x=s[s.length-1];if(x){for(let i of y){let a=t?.find(h=>h._key===i),m={_type:"@span",_key:u._key,children:[],markDef:a,markType:a?a._type:i,markKey:i};x.children.push(m),s.push(m),x=m}if(I(u)){let i=u.text.split(`
`);for(let a=i.length;a-- >1;)i.splice(a,0,`
`);x.children=x.children.concat(i.map(a=>({_type:"@text",text:a})))}else x.children=x.children.concat(u)}}return o.children}function F(e,n){let t=[],r;for(let o=0;o<e.length;o++){let s=e[o];if(s){if(!S(s)){t.push(s),r=void 0;continue}if(!r){r=w(s,o,n),t.push(r);continue}if(K(s,r)){r.children.push(s);continue}if((s.level||1)>r.level){let c=w(s,o,n);if(n==="html"){let u=r.children[r.children.length-1],y={...u,children:[...u.children,c]};r.children[r.children.length-1]=y}else r.children.push(c);r=c;continue}if((s.level||1)<r.level){let c=t[t.length-1],u=c&&N(c,s);if(u){r=u,r.children.push(s);continue}r=w(s,o,n),t.push(r);continue}if(s.listItem!==r.listItem){let c=t[t.length-1],u=c&&N(c,{level:s.level||1});if(u&&u.listItem===s.listItem){r=u,r.children.push(s);continue}else{r=w(s,o,n),t.push(r);continue}}console.warn("Unknown state encountered for block",s),t.push(s)}}return t}function K(e,n){return(e.level||1)===n.level&&e.listItem===n.listItem}function w(e,n,t){return{_type:"@list",_key:`${e._key||`${n}`}-parent`,mode:t,level:e.level||1,listItem:e.listItem,children:[e]}}function N(e,n){let t=n.level||1,r=n.listItem||"normal",o=typeof n.listItem=="string";if(D(e)&&(e.level||1)===t&&o&&(e.listItem||"normal")===r)return e;if(!("children"in e))return;let s=e.children[e.children.length-1];return s&&!I(s)?N(s,n):void 0}function q(e){let n="";return e.children.forEach(t=>{P(t)?n+=t.text:M(t)&&(n+=q(t))}),n}const z="html",R={number:({children:e})=>l.jsx("ol",{children:e}),bullet:({children:e})=>l.jsx("ul",{children:e})},H=({children:e})=>l.jsx("li",{children:e}),V=({children:e,value:n})=>l.jsx("a",{href:n?.href,children:e}),G={textDecoration:"underline"},J={em:({children:e})=>l.jsx("em",{children:e}),strong:({children:e})=>l.jsx("strong",{children:e}),code:({children:e})=>l.jsx("code",{children:e}),underline:({children:e})=>l.jsx("span",{style:G,children:e}),"strike-through":({children:e})=>l.jsx("del",{children:e}),link:V},j=(e,n)=>`[@portabletext/react] Unknown ${e}, specify a component for it in the \`components.${n}\` prop`,E=e=>j(`block type "${e}"`,"types"),Q=e=>j(`mark type "${e}"`,"marks"),X=e=>j(`block style "${e}"`,"block"),Y=e=>j(`list style "${e}"`,"list"),Z=e=>j(`list item style "${e}"`,"listItem");function ee(e){console.warn(e)}const te={display:"none"},L={types:{},block:{normal:({children:e})=>l.jsx("p",{children:e}),blockquote:({children:e})=>l.jsx("blockquote",{children:e}),h1:({children:e})=>l.jsx("h1",{children:e}),h2:({children:e})=>l.jsx("h2",{children:e}),h3:({children:e})=>l.jsx("h3",{children:e}),h4:({children:e})=>l.jsx("h4",{children:e}),h5:({children:e})=>l.jsx("h5",{children:e}),h6:({children:e})=>l.jsx("h6",{children:e})},marks:J,list:R,listItem:H,hardBreak:()=>l.jsx("br",{}),unknownType:({value:e,isInline:n})=>{let t=E(e._type);return l.jsx(n?"span":"div",{style:te,children:t})},unknownMark:({markType:e,children:n})=>l.jsx("span",{className:`unknown__pt__mark__${e}`,children:n}),unknownList:({children:e})=>l.jsx("ul",{children:e}),unknownListItem:({children:e})=>l.jsx("li",{children:e}),unknownBlockStyle:({children:e})=>l.jsx("p",{children:e})};function ne(e,n){let{block:t,list:r,listItem:o,marks:s,types:c,...u}=n;return{...e,block:b(e,n,"block"),list:b(e,n,"list"),listItem:b(e,n,"listItem"),marks:b(e,n,"marks"),types:b(e,n,"types"),...u}}function b(e,n,t){let r=n[t],o=e[t];return typeof r=="function"||r&&typeof o=="function"?r:r?{...o,...r}:o}function le({value:e,components:n,listNestingMode:t,onMissingComponent:r=ee}){let o=r||se,s=F(Array.isArray(e)?e:[e],t||z),c=T.useMemo(()=>n?ne(L,n):L,[n]),u=T.useMemo(()=>re(c,o),[c,o]);return l.jsx(l.Fragment,{children:s.map((y,g)=>u({node:y,index:g,isInline:!1,renderNode:u}))})}const re=(e,n)=>{function t(i){let{node:a,index:m,isInline:h}=i,p=a._key||`node-${m}`;return D(a)?s(a,m,p):S(a)?o(a,m,p):M(a)?c(a,m,p):r(a)?x(a,m,p,h):B(a)?u(a,m,p,h):P(a)?y(a,p):g(a,m,p,h)}function r(i){return i._type in e.types}function o(i,a,m){let h=$({node:i,index:a,isInline:!1,renderNode:t}),p=e.listItem,f=(typeof p=="function"?p:p[i.listItem])||e.unknownListItem;if(f===e.unknownListItem){let k=i.listItem||"bullet";n(Z(k),{type:k,nodeType:"listItemStyle"})}let d=h.children;if(i.style&&i.style!=="normal"){let{listItem:k,..._}=i;d=t({node:_,index:a,isInline:!1})}return l.jsx(f,{value:i,index:a,isInline:!1,renderNode:t,children:d},m)}function s(i,a,m){let h=i.children.map((d,k)=>t({node:d._key?d:{...d,_key:`li-${a}-${k}`},index:k,isInline:!1})),p=e.list,f=(typeof p=="function"?p:p[i.listItem])||e.unknownList;if(f===e.unknownList){let d=i.listItem||"bullet";n(Y(d),{nodeType:"listStyle",type:d})}return l.jsx(f,{value:i,index:a,isInline:!1,renderNode:t,children:h},m)}function c(i,a,m){let{markDef:h,markType:p,markKey:f}=i,d=e.marks[p]||e.unknownMark,k=i.children.map((_,O)=>t({node:_,index:O,isInline:!0}));return d===e.unknownMark&&n(Q(p),{nodeType:"mark",type:p}),l.jsx(d,{text:q(i),value:h,markType:p,markKey:f,renderNode:t,children:k},m)}function u(i,a,m,h){let{_key:p,...f}=$({node:i,index:a,isInline:h,renderNode:t}),d=f.node.style||"normal",k=(typeof e.block=="function"?e.block:e.block[d])||e.unknownBlockStyle;return k===e.unknownBlockStyle&&n(X(d),{nodeType:"blockStyle",type:d}),l.jsx(k,{...f,value:f.node,renderNode:t},m)}function y(i,a){if(i.text===`
`){let m=e.hardBreak;return m?l.jsx(m,{},a):`
`}return i.text}function g(i,a,m,h){let p={value:i,isInline:h,index:a,renderNode:t};n(E(i._type),{nodeType:"block",type:i._type});let f=e.unknownType;return l.jsx(f,{...p},m)}function x(i,a,m,h){let p={value:i,isInline:h,index:a,renderNode:t},f=e.types[i._type];return f?l.jsx(f,{...p},m):null}return t};function $(e){let{node:n,index:t,isInline:r,renderNode:o}=e,s=W(n).map((c,u)=>o({node:c,isInline:!0,index:u,renderNode:o}));return{_key:n._key||`block-${t}`,children:s,index:t,isInline:r,node:n}}function se(){}const ue=({value:e})=>{if(!e)return null;const n={types:{image:({value:t})=>{const r=t?.asset?.url;return r?l.jsxs("figure",{className:"portable-image",children:[l.jsx("img",{src:r,alt:t.alt||"",loading:"lazy"}),t.caption&&l.jsx("figcaption",{children:t.caption})]}):null},code:({value:t})=>l.jsxs("div",{className:"code-block",children:[t.language&&l.jsx("div",{className:"language-badge",children:t.language}),l.jsx("pre",{children:l.jsx("code",{className:`language-${t.language||"javascript"}`,children:t.code})})]}),callout:({value:t})=>l.jsxs("div",{className:`callout callout-${t.type||"info"}`,children:[t.title&&l.jsx("strong",{className:"callout-title",children:t.title}),t.message&&l.jsx("p",{className:"callout-message",children:t.message})]}),divider:()=>l.jsx("hr",{className:"portable-divider"}),videoEmbed:({value:t})=>{const r=ie(t?.url);return r?l.jsxs("figure",{className:"portable-video",children:[l.jsx("iframe",{src:r,width:"100%",height:"400",frameBorder:"0",allowFullScreen:!0,loading:"lazy",title:t.caption||"Embedded video"}),t.caption&&l.jsx("figcaption",{children:t.caption})]}):null},quoteBlock:({value:t})=>l.jsxs("blockquote",{className:"portable-quote",children:[l.jsx("p",{className:"quote-text",children:t.text}),t.author&&l.jsxs("footer",{className:"quote-author",children:["â€” ",t.author]})]}),highlight:({value:t})=>l.jsx("mark",{className:`highlight highlight-${t.color||"yellow"}`,children:t.text}),previewBlock:({value:t})=>l.jsxs("div",{className:`preview-block preview-${t.bgType||"light"}`,children:[t.title&&l.jsx("h4",{className:"preview-title",children:t.title}),t.description&&l.jsx("p",{className:"preview-description",children:t.description}),t.previewContent&&l.jsx("div",{className:"preview-content",children:t.previewContent})]})},block:{h1:({children:t})=>l.jsx("h1",{className:"portable-h1",children:t}),h2:({children:t})=>l.jsx("h2",{className:"portable-h2",children:t}),h3:({children:t})=>l.jsx("h3",{className:"portable-h3",children:t}),h4:({children:t})=>l.jsx("h4",{className:"portable-h4",children:t}),blockquote:({children:t})=>l.jsx("blockquote",{className:"portable-blockquote",children:t}),normal:({children:t})=>l.jsx("p",{className:"portable-p",children:t})},list:{bullet:({children:t})=>l.jsx("ul",{className:"portable-ul",children:t}),number:({children:t})=>l.jsx("ol",{className:"portable-ol",children:t})},listItem:{bullet:({children:t})=>l.jsx("li",{className:"portable-li-bullet",children:t}),number:({children:t})=>l.jsx("li",{className:"portable-li-number",children:t})},marks:{strong:({children:t})=>l.jsx("strong",{className:"portable-strong",children:t}),em:({children:t})=>l.jsx("em",{className:"portable-em",children:t}),code:({children:t})=>l.jsx("code",{className:"portable-code",children:t}),underline:({children:t})=>l.jsx("u",{className:"portable-underline",children:t}),"strike-through":({children:t})=>l.jsx("s",{className:"portable-strikethrough",children:t}),link:({value:t,children:r})=>l.jsx("a",{href:t?.href,target:"_blank",rel:"noopener noreferrer",className:"portable-link",children:r}),internalLink:({value:t,children:r})=>{const o=t?.reference?.slug?.current;return o?l.jsx("a",{href:`/notes/${o}`,className:"portable-internal-link",children:r}):r}}};return l.jsx(l.Fragment,{children:l.jsx("div",{className:A.portableText,children:l.jsx(le,{value:e,components:n})})})};function ie(e){if(!e)return null;if(e.includes("youtu")){const n=e.match(/v=([^&]+)/)?.[1]||e.match(/youtu\.be\/([^?]+)/)?.[1];return n?`https://www.youtube.com/embed/${n}`:null}if(e.includes("vimeo")){const n=e.match(/vimeo\.com\/(\d+)/)?.[1];return n?`https://player.vimeo.com/video/${n}`:null}return e}export{ue as default};
